import{a as s,Q as V}from"./QBtn.0ad5278d.js";import{Q as $,a as h,b as B,c as P,m,d as I}from"./QTable.e5c26aa5.js";import{Q,a as L,b as D,c as O}from"./QCard.f5b28e23.js";import{a as f}from"./axios.0ed95acd.js";import{A as g}from"./apiConfig.1e70a3d4.js";import{r as i,z as S,o as v,U as C,d as r,a,w as t,V as M,W as j,O as w,X as U,c as z}from"./index.5ebe2dc0.js";import"./use-dark.cd4d1793.js";import"./format.89b542e2.js";import"./scroll.7716672b.js";import"./use-key-composition.b507003b.js";const F={class:"tw-p-4"},R={class:"tw-flex tw-flex-row tw-justify-between"},W={class:"tw-font-roboto-condensed tw-font-bold tw-text-primary tw-text-sm"},X={class:"tw-flex tw-justify-center tw-gap-2"},G="",ie={__name:"PaquetesPage",setup(H){const d=i([{id:1,name:"Tacna"},{id:2,name:"Arequipa"},{id:3,name:"Madre de Dios"},{id:4,name:"Ayacucho"},{id:5,name:"Ucayali"},{id:6,name:"Lima"},{id:7,name:"San Martin"},{id:8,name:"Tumbes"},{id:9,name:"Loreto"}]),b=i([]),_=i([]),c=i(!0),q={page:1,rowsPerPage:10},u=i(!1),n=i({usuario:null,nodo_origen:null,nodo_destino:null}),p=i(!1),T=async()=>{try{const l=await f.get(`${g}/usuario/api/list/`);_.value=l.data.map(e=>({id:e.dni,name:`${e.nombres} ${e.apellidos}`}))}catch(l){console.error("Error fetching users:",l)}},y=async()=>{c.value=!0;try{const l=await f.get(`${g}/paquete/api/list/`);b.value=l.data}catch(l){console.error("Error fetching packages:",l)}finally{c.value=!1}},A=[{name:"index",label:"Nro.",align:"center"},{name:"id",label:"ID Paquete",align:"left",field:"id"},{name:"user",label:"Usuario",align:"left",field:l=>`${l.usuario}`},{name:"origin",label:"Origen",align:"left",field:l=>{var e;return((e=d.value.find(o=>o.id===l.nodo_origen))==null?void 0:e.name)||"Desconocido"}},{name:"destination",label:"Destino",align:"left",field:l=>{var e;return((e=d.value.find(o=>o.id===l.nodo_destino))==null?void 0:e.name)||"Desconocido"}},{name:"action",label:"Acciones",align:"center"}],E=()=>{u.value=!0,n.value={usuario:null,nodo_origen:null,nodo_destino:null}},k=()=>{u.value=!1},N=async()=>{console.log("Enviando paquete:",n.value),p.value=!0;try{await f.post(`${g}/paquete/api/create/`,n.value),y(),k()}catch(l){console.error("Error creating package:",l)}finally{p.value=!1}};return S(()=>{T(),y()}),(l,e)=>(v(),C("div",F,[r("div",R,[e[4]||(e[4]=r("h1",{class:"tw-text-2xl tw-p-3"},"Paquetes",-1)),a(s,{class:"tw-h-fit tw-self-center",color:"primary",label:"A\xF1adir Paquete",onClick:E})]),a($,{rows:b.value,columns:A,"row-key":"id",loading:c.value,filter:G,pagination:q},{header:t(o=>[a(B,{props:o},{default:t(()=>[(v(!0),C(M,null,j(o.cols,x=>(v(),z(I,{key:x.name,props:o},{default:t(()=>[r("span",W,U(x.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-index":t(o=>[a(P,{props:o},{default:t(()=>[w(U(o.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-action":t(o=>[a(P,{props:o},{default:t(()=>[r("div",X,[a(s,{"data-test":"edit-btn",class:"tw-bg-decoration",dense:"",round:"",flat:""},{default:t(()=>[a(V,{name:"edit",style:{color:"#f59e0b"}}),a(Q,null,{default:t(()=>e[5]||(e[5]=[w("Editar")])),_:1})]),_:1}),a(s,{"data-test":"remove-btn",class:"tw-bg-decoration",dense:"",round:"",flat:""},{default:t(()=>[a(V,{name:"delete",color:"red"}),a(Q,null,{default:t(()=>e[6]||(e[6]=[w("Eliminar")])),_:1})]),_:1})])]),_:2},1032,["props"])]),_:1},8,["rows","loading"]),a(h,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=o=>u.value=o)},{default:t(()=>[a(L,{style:{width:"700px","max-width":"80vw"}},{default:t(()=>[a(D,null,{default:t(()=>e[7]||(e[7]=[r("div",{class:"text-h6"},"Crear Paquete",-1)])),_:1}),a(D,null,{default:t(()=>[a(m,{modelValue:n.value.usuario,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.usuario=o),options:_.value,label:"Usuario","option-label":"name","option-value":"id","emit-value":"","map-options":"",filled:""},null,8,["modelValue","options"]),a(m,{modelValue:n.value.nodo_origen,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.nodo_origen=o),options:d.value,label:"Nodo de Inicio","option-label":"name","option-value":"id","emit-value":"","map-options":"",filled:""},null,8,["modelValue","options"]),a(m,{modelValue:n.value.nodo_destino,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.nodo_destino=o),options:d.value,label:"Nodo de Destino","option-label":"name","option-value":"id","emit-value":"","map-options":"",filled:""},null,8,["modelValue","options"])]),_:1}),a(O,{class:"tw-p-5"},{default:t(()=>[a(s,{loading:p.value,color:"primary",label:"Crear",onClick:N},null,8,["loading"]),a(s,{flat:"",label:"Cancelar",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ie as default};
